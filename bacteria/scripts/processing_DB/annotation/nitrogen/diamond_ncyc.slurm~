#!/bin/bash
# --------------------------------------------------
# Request resources here
# --------------------------------------------------
#SBATCH --job-name=urb_n_strict
#SBATCH --output=urb_n_strict.out
#SBATCH --account=barberan
#SBATCH --mail-type=ALL
#SBATCH --mail-user=mtoucedasuarez@hpc.arizona.edu
#SBATCH --partition=standard
#SBATCH --ntasks=28
#SBATCH --nodes=1
#SBATCH --mem=112gb
#SBATCH --time=50:00:00

# --------------------------------------------------
# Load modules here
# --------------------------------------------------
module load diamond/2.0.9


OUT_DIR="/xdisk/barberan/mtoucedasuarez/urban/nitrogen"
READS_OUT="/xdisk/barberan/mtoucedasuarez/urban/clean_reads"

# for loop over samples:
for sample in `awk '{print $1}' /groups/egornish/mtoucedasuarez/scripts/jobs/urban/virus/sample_id_list.txt`
do
    if [ "$sample" == "sample" ]; then continue; fi

    diamond blastx --db /groups/egornish/mtoucedasuarez/scripts/jobs/landuse/nitrogen/NCyc/data/NCyc_95.faa.gz --query $READS_OUT/${sample}_clean_1.fastq --outfmt 6 --out $OUT_DIR/${sample}_blastx.out -k 1 --evalue 0.000001  --salltitles  --quiet --more-sensitive

done
